@using Microsoft.AspNetCore.Mvc
@using System.Collections.Generic
@using SUPPLY.Models
@using Microsoft.Office.Interop.Excel;
@using Excel = Microsoft.Office.Interop.Excel;
@using SUPPLY;
@using System.IO;
@using ClosedXML.Excel;




@{
    ViewData["Title"] = "Home Page";
}

<div class="mb-3">
  <label for="formFile" class="form-label">Загрузите файл спецификации</label>
  <input class="form-control" type="file" id="formFile">
</div>


<a href="Home/Specification">Открыть спецификацию</a>

@{

  string path = "/Users/vladimirgubin/web-developer/SUPPLY/wwwroot/file/component.xlsx";
        
  var workbook = new XLWorkbook(path);  // Открыли книгу Excel
  var worksheet = workbook.Worksheet(1); // Выбрали Лист_1 книги Excel
  var rows = worksheet.RangeUsed().RowsUsed(); // Получаем все заполненные строки в файле
  var count = worksheet.RangeUsed().RowCount(); // Получаем количество заполненных строк
  var row2 = worksheet.Row(2); // Получаем указанную строку
  var renge = worksheet.Rows(2, count);
  // пример чтения строк файла.

  
  foreach (var row in @renge)
  {
    <div>@row.Cell(1).Value</div>
    <div>@row.Cell(2).Value</div>
    <div>@row.Cell(3).Value</div>

  }
}
